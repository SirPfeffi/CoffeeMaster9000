#:import dp kivy.metrics.dp

<MainScreen>:
    canvas.before:
        Color:
            rgba: 0.898, 0.91, 0.941, 1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: 'vertical'
        padding: dp(18)
        spacing: dp(12)

        BoxLayout:
            size_hint_y: None
            height: dp(70)
            Label:
                text: "CoffeeMaster9000"
                font_size: '28sp'
                bold: True
                color: 0.12, 0.12, 0.12, 1

        BoxLayout:
            size_hint_y: None
            height: dp(55)
            canvas.before:
                Color:
                    rgba: 1, 1, 1, 1
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [8,]
            Label:
                text: root.fun_text
                font_size: '16sp'
                color: 0.15, 0.15, 0.15, 1
                text_size: self.size
                halign: 'center'
                valign: 'middle'
                padding: [dp(10), dp(8)]

        BoxLayout:
            size_hint_y: None
            height: dp(150)
            spacing: dp(12)
            canvas.before:
                Color:
                    rgba: 1, 1, 1, 1
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [12,]
            BoxLayout:
                orientation: 'vertical'
                padding: dp(12)
                Label:
                    text: root.current_user_name
                    font_size: '22sp'
                    color: 0.1, 0.1, 0.1, 1
                Label:
                    text: root.current_user_balance
                    font_size: '20sp'
                    color: 0.2, 0.6, 0.2, 1
                Label:
                    text: root.balance_notice
                    font_size: '15sp'
                    color: 0.80, 0.2, 0.2, 1

        BoxLayout:
            size_hint_y: None
            height: dp(75)
            spacing: dp(12)
            Button:
                text: "-"
                size_hint_x: 0.2
                on_press: root.decrease_coffee_count()
            Label:
                text: f"{root.tr('gui.coffees_label')}: {root.coffee_count}"
                size_hint_x: 0.6
                font_size: '20sp'
            Button:
                text: "+"
                size_hint_x: 0.2
                on_press: root.increase_coffee_count()

        BoxLayout:
            size_hint_y: None
            height: dp(80)
            spacing: dp(12)
            Button:
                text: root.tr('gui.confirm_booking')
                on_press: root.book_coffee()
                background_normal: ''
                background_color: 0.09, 0.59, 0.53, 1
                color: 1, 1, 1, 1
                font_size: '18sp'

        BoxLayout:
            size_hint_y: None
            height: dp(80)
            spacing: dp(12)
            Label:
                text: root.tr('gui.beans_label')
                size_hint_x: 0.18
                font_size: '18sp'
            Button:
                text: "1 kg"
                background_normal: ''
                background_color: (0.102, 0.737, 0.612, 1) if root.selected_kg == 1 else (0.4, 0.4, 0.4, 1)
                on_press: root.set_selected_kg(1)
            Button:
                text: "2 kg"
                background_normal: ''
                background_color: (0.102, 0.737, 0.612, 1) if root.selected_kg == 2 else (0.4, 0.4, 0.4, 1)
                on_press: root.set_selected_kg(2)
            Button:
                text: "3 kg"
                background_normal: ''
                background_color: (0.102, 0.737, 0.612, 1) if root.selected_kg == 3 else (0.4, 0.4, 0.4, 1)
                on_press: root.set_selected_kg(3)
            Button:
                text: "4 kg"
                background_normal: ''
                background_color: (0.102, 0.737, 0.612, 1) if root.selected_kg == 4 else (0.4, 0.4, 0.4, 1)
                on_press: root.set_selected_kg(4)
            Button:
                text: "5 kg"
                background_normal: ''
                background_color: (0.102, 0.737, 0.612, 1) if root.selected_kg == 5 else (0.4, 0.4, 0.4, 1)
                on_press: root.set_selected_kg(5)

        BoxLayout:
            size_hint_y: None
            height: dp(70)
            spacing: dp(12)
            TextInput:
                id: bean_amount_input
                hint_text: root.tr('gui.beans_amount_hint')
                multiline: False
                input_filter: 'float'
                font_size: '16sp'
            Button:
                text: root.tr('gui.beans_book')
                size_hint_x: 0.38
                on_press: root.submit_bean_topup(bean_amount_input.text); bean_amount_input.text = ''
                background_normal: ''
                background_color: 0.2, 0.6, 0.86, 1
                color: 1, 1, 1, 1
                font_size: '17sp'

        BoxLayout:
            size_hint_y: None
            height: dp(60)
            spacing: dp(12)
            TextInput:
                hint_text: root.tr('gui.uid_simulation_hint')
                multiline: False
                on_text_validate: root.load_user_by_uid(self.text); self.text = ''
                font_size: '16sp'

        BoxLayout:
            size_hint_y: None
            height: dp(100)
            canvas.before:
                Color:
                    rgba: 1, 1, 1, 1
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [10,]
            Label:
                text: root.recent_bookings
                text_size: self.size
                halign: 'left'
                valign: 'top'
                font_size: '14sp'
                color: 0.1, 0.1, 0.1, 1
                padding: [dp(8), dp(8)]

        BoxLayout:
            size_hint_y: None
            height: dp(60)
            Label:
                text: root.feedback
                font_size: '16sp'
                color: 0.1, 0.1, 0.1, 1
                canvas.before:
                    Color:
                        rgba: (0.65, 0.95, 0.65, 1) if root.feedback_color == '#a6e6a6' else ((0.97, 0.65, 0.65, 1) if root.feedback_color == '#f7a6a6' else (1, 1, 1, 0))
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [8,]

        Widget:
            size_hint_y: 1
